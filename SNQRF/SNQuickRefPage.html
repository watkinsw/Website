<html lang="en-US">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width" />
        <title>ServiceNow Reference</title>
    
        <style>   
            /* General Page Styles */
            body {
                background-color: rgb(14, 25, 43);
                margin: 10px;
                padding: 10px;
                font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
                font-size: 1.025em;
                color: rgb(186, 186, 186);
                text-align: center;
            }
            header {
                color: hsl(221, 100%, 90%);
                font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
                text-align: center;
                font-size: 125%;
            }
            .section{
                color: #afc3fa;
            }
            .drop-down-header {
                cursor: pointer;
                color: #e6e6e6;
            }
            .drop-down-header:hover{
                text-decoration: underline;
            }
            .header-subtext{
                color: grey;
            }
            .hidden-text {
                font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
                display: none;
                text-align: left;                
            }
        </style>
    </head>

    <body>
        <div class="nav-bar">
            <ul style="list-style: none; display: flex; gap: 20px; padding: 0; margin: 0;">
            <li><a href="/" style="text-decoration: none; color: inherit">Home</a></li>
            <li><a href="/snqrf" style="text-decoration: none; color: inherit">SNQRF</a></li>
            <li><a href="/aboutme" style="text-decoration: none; color: inherit">About Me</a></li>
            <li><a href="/code" style="text-decoration: none; color: inherit">Code</a></li>
            </ul>
        </div>

        <header>
            <h1>Wesly's ServiceNow Quick Reference</h1>
            <p class="header-subtext">Test. This website will serve as a reference for ServiceNow tips/tricks I have learned over the years.<br> Note that some of these references are quoted from SN forums (in an effort to personally preserve them).</p>
        </header>

        <br>
        <br>
        <h2 class="section"> URL References</h2> <!-- begin section URL References-->

            <h3 class="drop-down-header" onclick="toggleText('DescendingTip')">How to display 'group by X' records in descending order</h3>
                <div id="DescendingTip" class="hidden-text">
                <p>The first parameter will sort in Ascending order whilst the latter in Descending order. APPEND THIS TO END OF URL.</p>
                <p>&sysparm_group_sort=COUNT</p>
                <p> &sysparm_group_sort=COUNTDESC</p>
                <p>If the above doesn't work, try one of these 2 parameters</p>
                <p>%26sysparm_group_sort%3DCOUNTDESC</p>
                <p>%26sysparm_group_sort%3DCOUNT</p>
                </div>

            <h3 class="drop-down-header" onclick="toggleText('PortalTip')">(Polaris) How to route to platform homepage instead of portal</h3>
                <p id="PortalTip" class="hidden-text">If Polaris Experience, append <br><strong>/now/nav/ui</strong><br> to the end of your base url. <br>
                    base url: <em>www.instance-name.service-now.com</em> or <em>www.instance-name.servicenowservices.com</em>
                    <br>
                </p>

        <!-- end section URL References-->

        <h2 class="section"> Code References (JavaScript ECMA 5 friendly)</h2> <!-- begin section Code References-->

            <h3 class="drop-down-header" onclick="toggleText('GlideRecordTemplate')">Glide Record Templates</h3>
                <pre id="GlideRecordTemplate" class="hidden-text">
                    <strong>Insert</strong> 
                    //Create a new Incident record and populate the fields with the specified values 
                    var gr = new GlideRecord('incident'); 
                    gr.initialize(); 
                    gr.short_description = 'Network problem'; 
                    gr.category = 'software'; 
                    gr.caller_id.setDisplayValue('Joe Employee'); 
                    gr.insert(); 
                    
                    <strong>GlideAggregate</strong>
                    //Retrieve all active incidents and log a count of records to the system log 
                    var gr = new GlideAggregate('incident'); 
                    gr.addQuery('active', true); 
                    gr.addAggregate('COUNT'); //COUNT, SUM, MIN, MAX, AVG. 
                    gr.query(); 
                    var incidents = 0; 
                    if (gr.next()){ 
                        incidents = gr.getAggregate('COUNT'); 
                        gs.log('Active incident count: ' + incidents); 
                    } 
                    
                </pre>

            <h3 class="drop-down-header" onclick="toggleText('OccurenceInArray')">Count # of occurences of an item in an array</h3>
                <pre id="OccurenceInArray" class="hidden-text">
                    function getOccurrence(array, value) { 
                        var count = 0; 
                        array.forEach((v) => (v === value && count++));
                        return count; 
                    }
                </pre>

            <h3 class="drop-down-header" onclick="toggleText('RemoveDuplicates')">Remove duplicates from an array</h3>
                <pre id="RemoveDuplicates" class="hidden-text"> 
                    function uniq(array) { 
                        var seen = {}; 
                        return array.filter(function(item) { 
                            return seen.hasOwnProperty(item) ? false : (seen[item] = true); 
                        }); 
                    } 
                </pre>

            <h3 class="drop-down-header" onclick="toggleText('test')">test</h3>
                <pre id="test" class="hidden-text"> 
                    1 or two words
                </pre>

        <!-- end section Code References-->

        <h2 class="section"> Other References</h2> <!-- begin section Other References-->

            <h3 class="drop-down-header" onclick="toggleText('text3')">Header 3</h3>
                <p id="text3" class="hidden-text">This is the additional text for Header 3.</p>

        <!-- end section Other References-->

    </body>

    <script>
        function toggleText(id) {
            const element = document.getElementById(id);
            if (element.style.display === "none" || element.style.display === "") {
                element.style.display = "inline-block";
            } else {
                element.style.display = "none";
            }
        }
    </script>

</html>